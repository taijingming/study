<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
</head>

<body>
    <div id="app"></div>
    <div class="nav">

    </div>

    <script src="./vueRouter/hashRouter.js">
        class HashRouter {
            constructor({ routes = [] }) {
                this.routes = routes // 路由表
                this.currenHash = '' // 当前路由
                this.refresh = this.refresh.bind(this) // hash 改变触发的回调， 这里改this是为调用的时候比较方便
                window.addEventListener('load', this.refresh)
                window.addEventListener('hashchange', this.refresh)
            }
            /**
             * 
             * @param {*} url 根据 url 拿到 # 后面的东西
             * @returns # 后面的东西
             */
            getUrlPath(url = '') {
                return url.indexOf('#') > -1 ? url.slice(url.indexOf('#') + 1) : '/'
            }
            refresh(eventCHange) {
                let newHash = '', oldHash = null;
                if (eventCHange.newURL) {
                    newHash = this.getUrlPath(eventCHange.newURL || '')
                    oldHash = this.getUrlPath(eventCHange.oldURL || '')
                } else {
                    newHash = this.getUrlPath(window.location.hash)
                }
                this.currenHash = newHash
                setTimeout(() => {
                    this.machComponent() // 匹配组件
                })
            }
            /**
             * 根据路由匹配对应的页面（组件）
             */
            machComponent() {
                let currenRoute = this.routes.find(item => item.path === this.currenHash)
                if (!currenRoute) {
                    currenRoute = this.routes.find(item => item.path === '/')
                }
                const app = document.querySelector('#app')
                app && (app.innerHTML = currenRoute.component)
            }
        }
    </script>
    <script>
        const routes = [
            {
                path: '/',
                name: 'home',
                component: '<h1>这是首页</h1>'
            },
            {
                path: '/about',
                name: 'about',
                component: '<h1>这是about</h1>'
            },
            {
                path: '/page1',
                name: 'page1',
                component: '<h1>这是page1</h1>'
            }
        ]
        var route = new HashRouter({ routes })
    </script>
</body>

</html>